<!DOCTYPE html>
<html lang="ru">
	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<title>TWA –ö–∞—Ç–∞–ª–æ–≥</title>
		<script src="https://telegram.org/js/telegram-web-app.js"></script>
		<style>
        /* –ë–∞–∑–æ–≤—ã–π —Å—Ç–∏–ª—å –¥–ª—è –∫–∞—Ç–∞–ª–æ–≥–∞ */
        body { margin: 0; padding: 20px; font-family: sans-serif; background-color: var(--tg-theme-bg-color); color: var(--tg-theme-text-color); }
        .product { padding: 10px; margin-bottom: 15px; border: 1px solid var(--tg-theme-secondary-bg-color); border-radius: 8px; }
    </style>
	</head>
	<body>
		<h1>–ö–∞—Ç–∞–ª–æ–≥ –ò–≥—Ä—É—à–µ–∫ üß∏</h1>

		<div class="product">
			<h2>–ú–∏—à–∫–∞ –¢–µ–¥–¥–∏</h2>
			<p>–¶–µ–Ω–∞: 2000 —Ä—É–±.</p>
			<button onclick="addToCart('–ú–∏—à–∫–∞ –¢–µ–¥–¥–∏', 2000)">–î–æ–±–∞–≤–∏—Ç—å</button>
		</div>

		<div class="product">
			<h2>–ú–∞—à–∏–Ω–∫–∞ LEGO</h2>
			<p>–¶–µ–Ω–∞: 1500 —Ä—É–±.</p>
			<button onclick="addToCart('–ú–∞—à–∏–Ω–∫–∞ LEGO', 1500)">–î–æ–±–∞–≤–∏—Ç—å</button>
		</div>

		<p id="status">–ö–æ—Ä–∑–∏–Ω–∞: 0 —Ç–æ–≤–∞—Ä–æ–≤</p>

		<button id="checkout"
			style="width: 100%; padding: 15px; background-color: var(--tg-theme-button-color); color: var(--tg-theme-button-text-color); border: none; border-radius: 8px; margin-top: 20px;">–û—Ñ–æ—Ä–º–∏—Ç—å
			–∑–∞–∫–∞–∑</button>

		<script>
        const tg = window.Telegram.WebApp;
        let cart = [];
        let total = 0;

        // --- –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è TWA ---
        tg.ready();
        
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ì–ª–∞–≤–Ω—É—é –∫–Ω–æ–ø–∫—É (–≤–º–µ—Å—Ç–æ –æ–±—ã—á–Ω–æ–π –∫–Ω–æ–ø–∫–∏ –û—Ñ–æ—Ä–º–∏—Ç—å –∑–∞–∫–∞–∑)
        const checkoutBtn = document.getElementById('checkout');
        checkoutBtn.style.display = 'none'; // –°–∫—Ä—ã–≤–∞–µ–º HTML –∫–Ω–æ–ø–∫—É
        
        tg.MainButton.text = '–û–§–û–†–ú–ò–¢–¨ –ó–ê–ö–ê–ó (0 —Ä—É–±.)';
        tg.MainButton.show();


        function updateCart() {
            total = cart.reduce((sum, item) => sum + item.price, 0);
            document.getElementById('status').innerText = `–ö–æ—Ä–∑–∏–Ω–∞: ${cart.length} —Ç–æ–≤–∞—Ä–æ–≤`;
            tg.MainButton.setText(`–û–§–û–†–ú–ò–¢–¨ –ó–ê–ö–ê–ó (${total} —Ä—É–±.)`);
            
            if (cart.length > 0) {
                tg.MainButton.show();
            } else {
                tg.MainButton.hide();
            }
        }

        function addToCart(name, price) {
            cart.push({ name, price, quantity: 1 });
            tg.HapticFeedback.notificationOccurred('success'); // –û–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å
            updateCart();
        }

        // --- –î–µ–π—Å—Ç–≤–∏–µ –ø—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ –ì–ª–∞–≤–Ω–æ–π –∫–Ω–æ–ø–∫–∏ ---
        tg.MainButton.onClick(() => {
            if (cart.length === 0) return;

            const orderData = {
                action: 'checkout',
                total: total,
                items: cart // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –º–∞—Å—Å–∏–≤ —Ç–æ–≤–∞—Ä–æ–≤
            };
            
            // –û–¢–ü–†–ê–í–ö–ê –î–ê–ù–ù–´–• –í TELEGRAF
            tg.sendData(JSON.stringify(orderData));
            
            tg.close(); // –ó–∞–∫—Ä—ã–≤–∞–µ–º TWA –ø–æ—Å–ª–µ –æ—Ç–ø—Ä–∞–≤–∫–∏
        });

    </script>
	</body>
</html>